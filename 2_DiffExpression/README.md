# Differential gene expression and gene ontology enrichment analysis
Expression levels were determined for each gene using the entire sequencing read (rather than only the 3â€™ end, as typical when determining Pol II location from NET-seq data) and normalized using DESeq2 (Love et al., 2014). Differential expression analysis between deletion strains (with replicates) and wild-type strains was performed using DESeq2 (Love et al., 2014) for all UCSC known genes. Genes were considered differentially expressed if they had an adjusted p-value < 0.05 and an absolute log2 fold change > 1.0. GO term enrichment analysis was performed using the PANTHER GO Enrichment Analysis (Ashburner et al., 2000; Mi et al., 2019; The Gene Ontology Consortium, 2019; Thomas et al., 2003) and enriched terms for biological processes, molecular function, and cellular components were recorded for up-regulated differentially expressed genes, down-regulated differentially expressed genes, and all differentially expressed genes. 

# To identify differentially expressed genes
1. Create files required for running DESeq2 (counts and sample matrix) by running `./Scripts/makeDESeqMatrix.sh Sample-1 Sample-2 SampleName`. This script can accommodate up to 4 wildtype samples and 6 perturbation samples. Running this command will result in two files:
   - `SampleName.mat.txt`, which is a gene x sample matrix containing un-normalized gene expression calculated from the full NET-seq read
   - `SampleName.cond.txt`, which is a properly formatted list of samples
2. Run DESeq2 with the command `./Scripts/DESeqAnalysis.R SampleName`. This will report the total number of DE genes and produce another two files:
   - `SampleName.ALLgenes.txt`, which is the complete output from running DESeq2
   - `SampleName.DEgenes.txt`, which is the output of DESeq2, filtered to only include those genes with pAdj < 0.05 and |Log2FoldChange| > 1. This can be used to create tables similar to **Table S2**
3. Create a volcano plot illlustrating differentially expressed genes with the command `./Scripts/plotVolcano.R SampleName`, which will save the plot to a file called `SampleName_volcano.svg`
4. To re-create **Figure 1C**, run the command `./Scripts/plotNumDEgenes.R` to produce the plot called `NumDEgenes.svg`. The input file for this script, `Screen_nDE.txt` was created by transcribing the output of the volcano plot script (Step 3) for each deletion strain (4 columns: Deletion strain name, number of differentially up-regulated genes, number of differentially down-regulated genes, total number of differentially expressed genes).
5. To re-create **Figure 1D**, run the command `./Scripts/plotCDFforDEgenes.R` to produce the plot called `CDFforDEgenes.svg`. The input file for this script, `DEgeneCount.txt`, was created by running the following command after DESeq2 (Step 2) was complete for each deletion strain: `cat *DEgenes.txt | cut -f 1 | grep -v baseMean | sort | uniq -c | awk 'BEGIN {OFS="\t"} {print $1, $2}' | sort -k1 -n  > DEgeneCount.txt`. A similar process can be completed for the enriched GO terms (see below) to produce **Figure S1E**
6. To re-create **Figure S1C-D**, run the command `./Scripts/plotDEgeneCor.R` to produce the plots called `DEgeneCor_DoublingTime.svg` and `DEgeneCor_SeqDepth.svg`. The input file fot this script, `Screen_DEcor.txt`, was created such that each row contains 5 columns (Deletion strain name, median number of reads sequenced across replicates, median doubling time of deletion strain in minutes, total number of DE genes observed, and the category of the factor deleted, as in **Figure 1B**). 

All of these analyses may be run while only considering the interior gene body to avoid potential biases of Pol II pausing at the TSS or pA sites. This analysis (which produced **Figure S1B**) is identical to the above analysis, but Step 1 is run with the command `./Scripts/makeDESeqMatrix_subgenic.sh Sample-1 Sample-2 SampleName` instead. 

# To identify gene ontology terms enriched in differentially expressed genes
1. Create lists of differentially expressed genes (just gene name, split by whether that gene is up or down regulated, or keep both together). This can be done with the following commands:
   - `cat SampleName.DEgenes.txt | grep -v baseMean | awk '($3 > 1) {print $0}' | cut -f1 > SampleName.DEgeneList.UP.txt` for up-regulated genes
   - `cat SampleName.DEgenes.txt | grep -v baseMean | awk '($3 < 1) {print $0}' | cut -f1 > SampleName.DEgeneList.DOWN.txt` for down-regulated genes
   - `cat SampleName.DEgenes.txt | grep -v baseMean | cut -f1 > SampleName.DEgeneList.ALL.txt` for all differentially expressed genes
2. Perform gene ontology enrichment analysis by uploading each file in turn to http://geneontology.org/, being sure to set the species to *S. cerevisiae*. This can be done for biological process, molecular function, and cell component. Download results from each run, naming each file such that it ends with `_GO.txt`
3. Create a list of all GO terms that are enriched in at least one deletion strain, as `ALL.GO.txt`
4. Create a matrix for heatmap creation with the command `./Scripts/findCommonGO.sh`. This will produce the file `GOoverlaps.txt`
5. Plot heatmap as in **Figure 1E** with the command `./Scripts/plotGOheatmap.R` to produce the plot called `GOheatmap.svg` and the additional file `plotGO_output.txt` which is similar to **Table S3**
