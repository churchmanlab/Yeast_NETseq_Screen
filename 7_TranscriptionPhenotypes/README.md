# Trends in differentially expressed genes
Frequently regulated genes were identified as those that had been differentially expressed in 8 or more deletion strains. GO enrichment, gene length, and type of promoter were all examined to understand if these genes were unique compared to all other genes. To perform the promoter-type analysis, we used the characterization of gene promoters as reported in (Basehoar et al., 2004). We also characterized several transcriptional phenotypes - antisense : sense ratio and pausing index around the TSS - for these frequently regulated genes in wild-type and perturbation conditions. We quantified the difference of these phenotypes in wildtype, comparing the values in genes never differentially expressed across all deletion strains and frequently regulated; the difference in these distributions was assessed with a Studentâ€™s t-test. We also examined these phenotypes split by the deletion strains in which the gene is differentially expressed and those in which it is not, quantifying both at the gene level and split according to phenotype in the wild-type condition.

# To correlate transcriptional phenotypes
1. Create direction-specific counts of differentially expressed genes across deletion strains. This can be done in the `2_DiffExpression/` directory with the commands `cat *DEgenes.txt | grep -v baseMean | awk -F "\t" '($3 > 1) {print $1}' | sort | uniq -c | awk 'BEGIN {OFS="\t"} {print $1, $2}' | sort -k1 -n > ../../GITHUB/7_TranscriptionPhenotypes/DEgenesUP.allStrainsCount.txt` and `cat *DEgenes.txt | grep -v baseMean | awk -F "\t" '($3 < -1) {print $1}' | sort | uniq -c | awk 'BEGIN {OFS="\t"} {print $1, $2}' | sort -k1 -n > ../../GITHUB/7_TranscriptionPhenotypes/DEgenesDOWN.allStrainsCount.txt`  Update Jan 2022: `cat *DEgenesNoAnti.txt | grep -v baseMean | awk -F "\t" '($3 > 1) {print $1}' | sort | uniq -c | awk 'BEGIN {OFS="\t"} {print $1, $2}' | sort -k1 -n > ../../GITHUB/7_TranscriptionPhenotypes/DEgenesUP.allStrainsCount.txt` and `cat *DEgenesNoAnti.txt | grep -v baseMean | awk -F "\t" '($3 < -1) {print $1}' | sort | uniq -c | awk 'BEGIN {OFS="\t"} {print $1, $2}' | sort -k1 -n > ../../GITHUB/7_TranscriptionPhenotypes/DEgenesDOWN.allStrainsCount.txt`
2. Make files to examine frequently regulated genes (significantly differentially expressed in at least 8 deletion strains). To do this, first create lists of genes that meet this threshold with the command `cat DEgenesUP.allStrainsCount.txt | awk -F "\t" '($1 >=8) {print $2}' > DEgenes.UP.8orMore.txt` and `cat DEgenesDOWN.allStrainsCount.txt | awk -F "\t" '($1 >=8) {print $2}' > DEgenes.DOWN.8orMore.txt`. Then run the script `./Scripts/makeFreqRegGeneFiles.R UP` and `./Scripts/makeFreqRegGeneFiles.R DOWN` to produce the follwoing files:
   - `DE_AntisenseRatio.UP.txt`
   - `DE_AntisenseRatio.DOWN.txt`
   - `DE_TssPI.UP.txt`
   - `DE_TssPI.DOWN.txt`
Note that you must have already calculated antisense and pausing index in wildtype for this script to work
3. Plot phenotypes by example gene to create plots similar to that in **Figure 7A** with the script `./Scripts/plotExampleGene.R GeneName UP/DOWN` to produce plots `DEboxplotExGene_GeneName_AntisenseRatio.UP/DOWN.svg` and `DEboxplotExGene_GeneName_TSSpi.UP/DOWN.svg`
4. Plot median phenotype values for frequently regulated genes, split by those strains in which each gene is differentially expressed and those in which it is not with the script `./Scripts/plotPhenotypeByGene.R`. The plots generated, `DEbyGeneMed_....svg` will resemble **Figure 7B, 7D, 7F, 7H**
5. Make a boxplot splitting phenotypes by wildtype value, as in **Figure 7C, 7E, 7G, 7I** with the command `./Scripts/plotPhenotypeSplitByWildtype.R UP/DOWN`, which will generate the plots `DEboxplot_....svg`
