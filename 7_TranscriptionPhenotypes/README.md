# Trends in differentially expressed genes
For those deletion strains with at least 2 replicates, for which differentially expressed genes could be identified, quantifiable transcription features (i.e. antisense : sense transcription ratios, TSS pausing index, and poly(A) pausing index) were split by DE-status of the gene (i.e. differentially up-regulated, differentially down-regulated, or not differentially expressed). The median values of each transcription feature was compared to the ratio of that feature for differentially expressed genes to not differentially expressed genes for each deletion strain. Trend lines were plotted as Gaussian smoothed curves, with boundaries defined by the 95% confidence interval.

# To correlate transcriptional phenotypes
1. Create direction-specific counts of differentially expressed genes across deletion strains. This can be done in the `2_DiffExpression/` directory with the commands `cat *DEgenes.txt | grep -v baseMean | awk -F "\t" '($3 > 1) {print $1}' | sort | uniq -c | awk 'BEGIN {OFS="\t"} {print $1, $2}' | sort -k1 -n > ../../GITHUB/7_TranscriptionPhenotypes/DEgenesUP.allStrainsCount.txt` and `cat *DEgenes.txt | grep -v baseMean | awk -F "\t" '($3 < -1) {print $1}' | sort | uniq -c | awk 'BEGIN {OFS="\t"} {print $1, $2}' | sort -k1 -n > ../../GITHUB/7_TranscriptionPhenotypes/DEgenesDOWN.allStrainsCount.txt`
2. Measure the transcriptional phenotypes (antisense : sense ratio and TSS pausing index) in wildtype with the command `./Scripts/plotWtByPhenotype.R` to produce plots `DEgenes_inWT_AntisenseSenseRatio.svg` and `DEgenes_inWT_TSSpi.svg`, similar to those in **Figure S8C-D**. Note that you must have already calculated antisense and pausing index in wildtype for this script to work
3. Make files to examine frequently regulated genes (significantly differentially expressed in at least 8 deletion strains). To do this, first create lists of genes that meet this threshold with the command `cat DEgenesUP.allStrainsCount.txt | awk -F "\t" '($1 >=8) {print $2}' > DEgenes.UP.8orMore.txt` and `cat DEgeneDOWN.allStrainsCount.txt | awk -F "\t" '($1 >=8) {print $2}' > DEgenes.DOWN.8orMore.txt`. Then run the script `./Scripts/makeFreqRegGeneFiles.R UP` and `./Scripts/makeFreqRegGeneFiles.R DOWN` to produce the follwoing files:
   - `DE_AntisenseRatio.UP.txt`
   - `DE_AntisenseRatio.DOWN.txt`
   - `DE_TssPI.UP.txt`
   - `DE_TssPI.DOWN.txt`
4. Plot phenotypes by example gene to create plots similar to that in **Figure 7A** with the script `./Scripts/plotExampleGene.R GeneName UP/DOWN` to produce plots `DEboxplotExGene_GeneName_AntisenseRatio.UP/DOWN.svg` and `DEboxplotExGene_GeneName_TSSpi.UP/DOWN.svg`
5. Plot median phenotype values for frequently regulated genes, split by those strains in which each gene is differentially expressed and those in which it is not with the script `./Scripts/plotPhenotypeByGene.R`. The plots generated, `DEbyGeneMed_....svg` will resemble **Figure 7B, 7D, 7F, 7H**
6. Make a boxplot splitting phenotypes by wildtype value, as in **Figure 7C, 7E, 7G, 7I** with the command `./Scripts/plotPhenotypeSplitByWildtype.R UP/DOWN`, which will generate the plots `DEboxplot_....svg`
