# Extracting pause positions
Pauses were identified in previously annotated transcription units of well-expressed genes (average of > 5 reads per base-pair in two replicates). Pauses were defined as having reads higher than 3 standard deviations above the mean of the surrounding 200 nucleotides which do not contain pauses. Mean and standard deviation were calculated from a negative binomial distribution fit to the region of interest. Pauses were required to have at least 4 reads regardless of the gene’s sequencing coverage. Pauses were considered reproducible and used in downstream analyses when the Irreproducible Discovery Rate (IDR) is > 1% between two replicates. To calculate the IDR of each pause, log10 of pause strength (number of reads in pause) for each replicate was used as a proxy for pause score. IDR was calculated using the est.IDR function of the idr R package (mu = 3, sigma = 1, rho = 0.9, p = 0.5) (Li et al., 2011) . 

# Pol II pausing loci
Pause density was calculated as the ratio of total number of pauses to the total length of the genome considered when extracting pause positions (combined length of all well-expressed genes in both replicates of each deletion strain). To identify deletions that induced similar pausing patterns, 8,356 pauses were found to be shared in at least two strains and in regions sufficiently covered in multiple deletion strains. Shared pauses were visualized with a heatmap, clustered on both axes using the eisenCluster correlation clustering method in the hybridHclust R package (Chipman and Tibshirani, 2006), which takes into account missing data (where there was not enough coverage to confidently identify pausing in a particular deletion strain). When calculating distribution of pauses across the gene body, all genes in which pauses were identified were normalized in length; the 5’ gene region was defined as the first 15% of each gene, the mid-gene region was defined as extending from the 15th percentile of gene length to the 85th percentile, and the 3’ gene region was defined as starting at 85% of gene length and extending to the annotated poly(A) site. The scrambled control for the pausing location analysis was created by randomly scrambling all identified pauses in all deletion strains across the gene in which they were discovered. All analyses related to sequence motifs underlying pause loci were conducted using the MEME suite of tools (Bailey et al., 1994, 2009).  The sequence ± 10 bp around each identified, reproducible pause (as well as the matched scrambled control) was extracted and used to run the MEME tool using parameters to find 0 - 1 motif per sequence, motifs 6 - 21 bp in length, and up to 10 motifs with an E-value significance threshold of 0.05 (Bailey et al., 1994). These significant motifs were compared to known transcription factor binding site motifs in the YEASTRACT_20130918 database (Teixeira et al., 2014) using the TOMTOM tool (Gupta et al., 2007) using default parameters, calling all hits as significant with an E-value greater than 0.1. TOMTOM searches were only performed on those motifs with a relative entropy greater than 5 and only the top match is reported.

# To extract pause loci
1. First, pause loci need to be identified in each replicate. This can be done with the command `./Scripts/run_findPauses.sh SampleName`. Note that this is best submitted as a job to a cluster, as the calculations can take up to a day. This will result in the output files `SampleName-1.pausesNB_T3.???.bed`, which contain the loci of each pause in each replicate on each strand.
2. Next, calculate the overall reproducibility and identify those reproducible pauses using IDR. This can be done using the command `./Scripts/IDR.sh`. This will produce a file of reproducible pauses, `SampleName_PASS_pauseScore.txt`,which can be transformed into a bedGraph file and used in a genome browser such as IGV to look at data similar to that displayed in **Figure 4B**. It will also produce a scatterplot, a file called `SampleName_IDRscatter.svg`, which is similar to that shown in **Figure 4C**. Note that this requires a file called `readTotal.txt` with 2 columns, one for the name of each replicate, and the other with the total number of uniquely-mapping reads in that sample. 
3. Reproducibility of pauses across all deletion strains can be assessed using the command `./Scripts/plot_IDRrep.R`, which will produce the plot `IDRrep.svg`, which is similar to **Figure S5A**
4. To calculate pause density, as in **Figure 4D**, use the script `./Scripts/calcPauseDensitybyGene.sh deletionStrains.txt`. This will produce files containing the pause density of every gene in every deletion strain (files called `SampleName.pauseDensity.txt`) as well as a box plot called `pauseDensity.svg`
5. To calculate pause strength (median percent of reads in pauses), as shown in **Figure S5B**, use the script
These values can be correlated to sequencing depth, as is **Figure S5C** with the script `./Scripts/calcPauseStrength.sh` to generate the plot `pauseStrength.svg`
6. In order to perform the PCA analysis on shared pause loci across deletion strains, as depicted in **Figure 4E**, use the script `./run_makeMutVector.sh deletionStrains.txt` to generate the requisit matrix file to then run `./Scripts/pausePCA.R` to produce the final plot `pausePCA.svg`
7. Shared pause loci can also be visualized as a heatmap, like that shown in **Figure S5D**. In order to generate this figure, all pause loci for all deletion strains must be converted into vector form. This can be done by executing the script `./Scripts/makeLociVector.sh deletionStrains.txt`. Then, create the heatmap with the command `./Scripts/plot_pauseLociHeatmap.R`, which will generate the plot saved to a file called `pauseHeatmap.svg`. Note that this script may take a while to run!
8. Pol II pause postion varies across the gene body, as illustrated in **Figure 4F**. Before this figure can be reproduced, first all pauses must be shuffled within high-coverage genes. This can be done with the command `./Scripts/shufflePauses.sh SampleName`, which will prouce the file `SampleName.IDRrep.SHUFFLE.bed`. Combine all shuffled pause files together with the command `cat *.IDRrep.SHUFFLE.bed > ALL.IDRrep.SHUFFLE.bed`.
9. Now, real and shuffled pauses can be overlapped with regions of the gene body, which can be done with the command `./Scripts/countOverlap.sh deletionStrains.txt`. Finally, we can generate the bar plot with proportion of pauses in each gene region for each deletion strain with the command `./Scripts/plotOverlap.R`, which will produce the file `PauseGeneOverlap.svg`
