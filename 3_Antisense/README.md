# Antisense transcription
For analysis of divergent antisense transcription at tandem genes, the sum of reads on the strand opposite the coding gene from 100 bp upstream of the sense TSS to 600 bp upstream of the sense TSS is divided by the sum of reads from the sense TSS to 500 bp downstream of the TSS on the coding strand. The genes selected were tandem gene pairs with each gene transcribed in the same direction and were obtained from (Churchman and Weissman, 2011). For analysis of antisense transcription, Pol II genes that did not overlap with another coding gene were chosen. The region analyzed spanned from the TSS to the polyadenylation site as defined by taking the most abundant TSS and polyadenylation site from (Pelechano et al., 2013). The sum of reads from the antisense strand was divided by the sum of reads from the sense strand. For all analyses, the log2 antisense to sense ratio was used. To generate antisense heatmaps, the log2 RPKM of NET-seq reads was used. Analysis at coding genes ranged from 250 bp upstream of the TSS to 4000 bp downstream of the coding TSS. To allow comparison between mutant and wild-type samples, a pseudocount of 1 was added to every position in all samples before calculating the log2 RPKM. Differential heatmaps were calculated by taking the log2 ratio of mutant / wild-type RPKM at each position. The heatmap illustrating the correlation of antisense : sense transcription ratios across deletion strains was created by calculating Pearson correlation of this ratio across all protein-coding non-overlapping genes. However, to increase the illustrated dynamic range, the first principal component was computationally removed before calculating these correlations.

# To quantify antisense transcription in the gene body as well as upstream tandem to genes
1. Calculate sense, antisense, and the antisense : sense ratio for all non-overlapping protein-coding genes in each deletion strain with the command `./Scripts/calcAStoSratio.sh SampleName`. This will produce 4 files:
   - `CodingAntisense/SampleName.geneNETseqRatio.pos.bed`
   - `CodingAntisense/SampleName.geneNETseqRatio.neg.bed`
   - `TandemAntisense/SampleName.tandemNETseqRatio.pos.bed`
   - `TandemAntisense/SampleName.tandemNETseqRatio.neg.bed`
The following analyses can be performed for both coding antisense and tandem antisense.
2. Combine all coding files together, labeled with sample name. This can be accomplished by executing the command `cat SampleName.geneNETseqRatio.*.bed | awk -F "\t" -v sample="SampleName" 'BEGIN {OFS="\t"} {print $0, sample}' >> ALL.geneNETseqRatio.bed` for all samples. 
3. Visualize the distribution of antisense : sense ratios across all deletion strains with the command `./Scripts/plotAStoSboxplot.R CodingAntisense/ALL.geneNETseqRatio.bed coding` and `./Scripts/plotAStoSboxplot.R TandemAntisense/ALL.tandemNETseqRatio.bed tandem` to create the plots `boxplotAStoSratio_coding.svg` and `boxplotAStoSratio_tandem.svg`, respectively. These are similar to **Figure 2B** and **Figure S2B**
4. To calculate the correlation between median tandem and coding antisense : sense ratios, use the command `./Scripts/plotCodingTandemCor.R` to create the plot `CodingTandemCor.svg`, which should resemble **Figure S2C**
5. Generate heatmaps of antisense transcription across the entire gene body as in **Figure 2C-E** and **Figure S2F** with the command `./Scripts/run_overlap.sh`. This script is written to produce plots for all deletion strains, and will need to be modified if only interested in select samples. This will produce heatmaps named `SampleName_wholeGeneASHeatmap.pdf`
6. To create a heatmap of antisense : sense ratios for each gene across all samples, normalized by the ratio in wildtype, first you must calculate the normalized antisense and sense levels. This is accomplished with the command `./Scripts/compareToWt.R CodingAntisense/ALL.geneNETseqRatio.bed coding`, which will generate the file `CodingAntisense/ALL.geneNETseqRatio_withWTratio.bed`. Then, this file can be used to make the heatmap with the command `./Scripts/plot_geneHeatmap_wtRatio.R` to generate the plot `ALL_GeneHeatmap_wtRatio.svg`. This plot is similar to **Figure 2F**
7. The genes that fall within the Set2 / Rco1 cluster are listed in the file `Set2Rco1Genes.txt`. The length of these genes can be compared to all genes to generate the plot like **Figure 2G** with the script `./Scripts/plotClusterGeneLength.R` to generate the plot `clusterGeneLengthBoxplot.svg`
8. To calculate the correlations of antisense transcription with gene length for all deletion strains, run the code 

