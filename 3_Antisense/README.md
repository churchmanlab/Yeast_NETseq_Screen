# Antisense transcription
For analysis of divergent antisense transcription at tandem genes, the sum of reads on the strand opposite the coding gene from 100 bp upstream of the sense TSS to 600 bp upstream of the sense TSS is divided by the sum of reads from the sense TSS to 500 bp downstream of the TSS on the coding strand. The genes selected were tandem gene pairs with each gene transcribed in the same direction and were obtained from (Churchman and Weissman, 2011). For analysis of antisense transcription, Pol II genes that did not overlap with another coding gene were chosen. The region analyzed spanned from the TSS to the polyadenylation site as defined by taking the most abundant TSS and polyadenylation site from (Pelechano et al., 2013). The sum of reads from the antisense strand was divided by the sum of reads from the sense strand. For all analyses, the log2 antisense to sense ratio was used. To generate antisense heatmaps, the log2 RPKM of NET-seq reads was used. Analysis at coding genes ranged from 250 bp upstream of the TSS to 4000 bp downstream of the coding TSS. To allow comparison between mutant and wild-type samples, a pseudocount of 1 was added to every position in all samples before calculating the log2 RPKM. Differential heatmaps were calculated by taking the log2 ratio of mutant / wild-type RPKM at each position. The heatmap illustrating the correlation of antisense : sense transcription ratios across deletion strains was created by calculating Pearson correlation of this ratio across all protein-coding non-overlapping genes. However, to increase the illustrated dynamic range, the first principal component was computationally removed before calculating these correlations.

# To quantify antisense transcription in the gene body as well as upstream tandem to genes
1. Calculate sense, antisense, and the antisense : sense ratio for all non-overlapping protein-coding genes in each deletion strain with the command `./Scripts/calcAStoSratio.sh SampleName`. This will produce 4 files:
   - `CodingAntisense/SampleName.geneNETseqRatio.pos.bed`
   - `CodingAntisense/SampleName.geneNETseqRatio.neg.bed`
   - `TandemAntisense/SampleName.tandemNETseqRatio.pos.bed`
   - `TandemAntisense/SampleName.tandemNETseqRatio.neg.bed`
The following analyses can be performed for both coding antisense and tandem antisense.
2. Combine all coding files together, labeled with sample name. This can be accomplished by executing the command `cat SampleName.geneNETseqRatio.*.bed | awk -F "\t" -v sample="SampleName" 'BEGIN {OFS="\t"} {print $0, sample}' >> ALL.geneNETseqRatio.bed` for all samples. 
3. To visualize the distribution of antisense transcription across all deletion strains, first pull out 'anti' genes from DESeq2 results produced in 2_DiffExpression: `for mut in $muts; do grep '^anti' ${mut}.ALLgenes.txt > ${mut}.AntiOnly.txt; done`  then make files with only the Log2FC column, along with strain name: `for mut in $muts; do
awk -v m=$mut '{print $1"\t"$3"\t"m}' ${mut}.AntiOnly.txt > ${mut}.AntiOnlyLog2FC.txt; done` and combine all files: `cat *.AntiOnlyLog2FC.txt > ALL.AntiOnlyLog2FC.txt`. Finally run `./plotAS_log2foldCh_boxplot.R` to produce the file boxplot_AS.pdf as in **Figure 2B**  

3alt. Visualize the distribution of antisense : sense ratios across all deletion strains with the command `./Scripts/plotAStoSboxplot.R CodingAntisense/ALL.geneNETseqRatio.bed coding` and `./Scripts/plotAStoSboxplot.R TandemAntisense/ALL.tandemNETseqRatio.bed tandem` to create the plots `boxplotAStoSratio_coding.svg` and `boxplotAStoSratio_tandem.svg`, respectively. These are similar to **Figure 2B** and **Figure S2B**, but were removed in favor of (3) above.
5. To calculate the correlation between median tandem and coding antisense : sense ratios, use the command `./Scripts/plotCodingTandemCor.R` to create the plot `CodingTandemCor.svg`, which should resemble **Figure S2C**
6. Generate heatmaps of antisense transcription across the entire gene body as in **Figure 2C-E** and **Figure S2F** with the command `./Scripts/run_overlap.sh`. This script is written to produce plots for all deletion strains, and will need to be modified if only interested in select samples. This will produce heatmaps named `SampleName_wholeGeneASHeatmap.pdf`
7. To create a heatmap of antisense : sense ratios for each gene across all samples, normalized by the ratio in wildtype, first you must calculate the normalized antisense and sense levels. This is accomplished with the command `./Scripts/compareToWt.R CodingAntisense/ALL.geneNETseqRatio.bed coding`, which will generate the file `CodingAntisense/ALL.geneNETseqRatio_withWTratio.bed`. Then, this file can be used to make the heatmap with the command `./Scripts/plot_geneHeatmap_wtRatio.R` to generate the plot `ALL_GeneHeatmap_wtRatio.svg`. This plot is similar to **Figure 2F**
8. The genes that fall within the Set2 / Rco1 cluster are listed in the file `Set2Rco1Genes.txt`. The length of these genes can be compared to all genes to generate the plot like **Figure 2G** with the script `./Scripts/plotClusterGeneLength.R` to generate the plot `clusterGeneLengthBoxplot.svg`
9. To calculate the correlations of antisense transcription with gene length for all deletion strains, run the code `./Scripts/antisense_geneLength.R SampleName` to calculate the Pearson correlation and produce the plot as in **Figure S2D0E**

# ChIP-nexus sequencing alignment
ChIP-nexus reads were aligned as follows. First, all reads were filtered for the presence of the fixed barcode (CTGA), beginning at position 6 of the read. Next, the adapter sequence was trimmed using cutadapt with the following parameters: cutadapt -f fastq -a AGATCGGAAGAGCACACGTCT -O 3 -m 22 --length-tag ‘length=’. Lastly, before alignment to the genome, the molecular barcode was removed using custom python scripts. As the ChIP-nexus samples were spiked with S. pombe, the reads were aligned to a combined genome containing both the S. cerevisiae and S. pombe genomes. Reads were aligned using Bowtie version 1.1.1 (Langmead et al., 2009) with the following parameters: -v 2 -M 1 --best -S. Plus and minus strand coverage were then combined and coverage files were then generated using BEDtools version 2.23.0 with the following parameters: genomeCoverageBed -d -5. Only the 5’ end of the read, which corresponds to the point of crosslinking is recorded. The S. cerevisiae and S. pombe data were then separated and S. cerevisiae coverage files were normalized by the total number of mapped S. pombe reads.

# ChIP-nexus average profiles, occupancy, and mutual information analysis
Genes used for analysis of ChIP-seq data for non-overlapping coding genes were obtained as described above (the same genes were used for NET-seq and ChIP-seq analyses). All Pol II genes were obtained from the Saccharomyces Genome database (http://www.yeastgenome.org) and coordinates for TSS and polyadenylation sites were obtained by taking the maximum utilized TSS and polyadenylation sites from (Pelechano et al., 2013). ChIP-nexus profiles at non-overlapping protein-coding genes were obtained by taking the average profil using a sliding window of 25 bp. Data were plotted along with micrococcal nuclease (MNase) sequencing data from (Weiner et al., 2015) as a comparison for wild-type nucleosome occupancy. 

Gcn5 and Eaf1 (NuA4) are mostly specific to H3 and H4, respectively, however some cross-talk has been reported at select residues (Clarke et al., 1999; Kuo et al., 1996). Thus, we analyzed the acetylation of residues where no crosstalk between Gcn5 and NuA4 has been observed in vivo or or vitro (Clarke et al., 1999; Grant et al., 1999; Kuo et al., 1996). Occupancy for H3K23Ac and H4K12Ac were determined by summing the S. pombe normalized reads for each sample at each gene. To calculate mutual information between H3K23Ac, H4K12Ac, and NET-seq data, antisense : sense ratios for 4 biological replicates of wild-type, gcn5∆, and eaf1∆ were compared to H3K23Ac and H4K12Ac levels, using the infotheo R package. The mean mutual information value is then plotted along with error bars representing standard deviation of the mutual information values. P values are calculated from a two-sample two-sided t-test. 

# To analyze ChIP-nexus data in relation to antisense transcription
1. To create a boxplot as in **Figure 2H**, use the script `./Scripts/plotChIPboxplot.R` to produce the boxplot `ChIPnexus_acetylation_boxplot.svg`. 
