# Random forest classifier for Pol II pausing loci
The predictive value of DNA features for identifying Pol II pause loci was determined using a Random Forest model with the randomForest R package (Breiman, 2001). All reproducible Pol II pause loci were included in these analyses, as were an equal number of shuffled control loci. The shuffled control loci were selected to maintain the same number of real and control loci in each gene, controlling for effects of differential gene expression. In total, 51 DNA features were compiled for all pause loci (Table S4) (Chiu et al., 2016; Oberbeckmann et al., 2019; Pelechano et al., 2013; Turner and Mathews, 2010; Umeyama and Ito, 2018; Vinayachandran et al., 2018; Weiner et al., 2015). Feature importance scores were generated using a random forest classifier with 75% training and 25% testing sets; for wild-type yeast, this is 9,245 training and 3,082 testing loci. Due to the low number of reproducible pauses identified in the dhh1∆ deletion strain, it was excluded from these analyses.

Reported feature importance values are the mean decreases of accuracy over all out-of-bag cross validated predictions, when a given feature is permuted after training, but before prediction. Optimized parameters were selected for random forest classifiers trained using all features or a limited set of DNA features (Figure S35). For all features, ncat = 5, mtry =  15, ntrees = 2500; for selected limited features,  ncat = 5, mtry = 2, ntrees = 2500. ROC curve and AUC measurements were determined from binary prediction probabilities and calculated using the ROCR R package (Sing et al.). The mean and standard error of the mean AUC is calculated from 10 iterations of training and testing the model on wild-type pauses. Prediction accuracy was determined by measuring the difference between the model’s predictions on a held-out test set and measured variables. The baseline score was determined using a “null” parameter that has the same value for every training and testing pair; thus, baseline represents the prediction accuracy with no additional information added to the model. To assess the transferability of a random forest classifier trained on Pol II pause loci in one strain, a model was trained on 100% of real and shuffled control Pol II loci from one deletion strain and then tested on all those pause loci in a second deletion strain that were not included in the training set.

# To perform motif analyses on sequences underlying pauses
1. First, we need to extract the sequences (±10 bp) underlying all real and shuffled Pol II pauses. Pol II pauses were shuffled for the gene position analysis in step 5; we will use those same files here again. To perform the MEME suite analyses that generate **Figure 5A-B** and **Table S4**, run the script `./Scripts/getMotif.sh deletionStrains.txt`. Images of motifs can be accessed via the html files generated from this analysis

# To create a random forest classifer for Pol II pause loci
1. First, we analyzed the distributions of chromatin feature values around real and shuffled Pol II pauses. Pol II pauses were shuffled for the gene position analysis in step 5; we will use those same files here again. For these analyses, we need to create files where each row is a pause location (real or shuffled) and each column is the value of a feature of interest. These files can be created with the script `./Scripts/calcFeatures.R SampleName Real/Shuffled`. This script relies on previously reported data, as cited in **Table S5**. Real and shuffled files for each sample can be combined with the command `SampleName.IDRrep.PAUSESwithFEATURES_*.bed > SampleName.IDRrep.PAUSESwithFEATURES.bed`
2. To generate the sequence heatmap of nucleotide enrichment under pauses, as shown in **Figure 5C**, the frequency of every tri-nucleotide for real and shuffled pauses (in wild-type) was calculated in Excel. See `PauseSeqFreq.xlsx` for the template. Then, the heatmap was created using the script `Scripts/plotSeqHeatmap.R`, which will generate the plot saved to `TriNucSeq_Heatmap.svg`
3. Before modeling, we visualized the distribution of each continuous feature underlying real and shuffled pauses, as shown in **Figure 5D-F** and **Figure S6A**. These boxplots can be generated for each feature of interest using the script `./Scripts/plotFOIboxplot.R SampleName FeatureOfInterest`, which generates the plot `SampleName_FeatureOfInterest.featureDistribution.svg`. This script also performs the t-test, for which output values are reported in **Table S6**
4. This script should be first run on wild-type data, on which parameters are optimized; parameters must be optimized for each iteration of the random forest classifier. This can be accomplished with the script `./Scripts/pickParameters.R SampleName nCat`. The `nCat` variable refers to the number of categories in which continuous variables should be discritized (sampled 3 - 5 in the manuscript). Optimal parameters, as measured by accuracy, can be visualized, as in **Figure S6D-E** with the script `./Scripts/plotParameters.R`
Note: there is a line in this script in which you may select specific features. This also exists in the `./Scripts/randomForest.R` script and can be used to perform the Features of Interst analyses discussed in the paper (**Figure 5I**, **FigureS6B-C**). 
5. Finally, implement the complete random forest classifier. This can be run with the script `./Scripts/randomForest.R SampleName mtry ntree`. The final two parameters should be those from the optimization in step 4. This script gives the following outputs:
   - `SampleName.Category_importance.txt` (for each category, which can be used to generate tables in **Figure 5H-I**)
   - `AUCvalues.txt` (lists AUC for each category)
   - `SampleName.ROC.svg` (similar to **Figure 5G**, **Figure 6C**, and **Figure S7D,F,H**)
6. Combine all importance values together into a file called `ALL.importance.txt`. Then, create heatmaps of the importance values, as in **Figure S7B** with the script `./Scripts/plotAUC.Importance.R`. This script also generates an AUC heatmap, as in **Figure S6A**. 
7. In order to correlate number of pauses with AUC values, as in **Figure S7A** generate a text file similar to `AUC_nPause.txt` and then run the script `./Scripts/plotAUCnPauseCor.R` to generate the plot  `AUCnPauseCor.svg`.
8. To perform the pairwise training analysis, as was done to generate **Figure 6D**, use the script `./Scripts/pairwiseTraining.R deletionStrains.txt MTRY NTREE`. This will produce the file `AUCvalues_pairwise.txt`. Then, you can generate the heatmap to visualize these values with the command `./Scripts/plot_paiwiseTraining_cluster.R` to generate the plot in the file `pairwiseTrainingHeatmap_cluster.svg`.
